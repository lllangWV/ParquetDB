<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="ParquetDB with the Jarvis Dataset DFT_3D" href="Example%203%20-%20Jarvis-dft_3d.html" /><link rel="prev" title="3D Alexandria Database" href="Example%201%20-%203D%20Alexandria%20Database.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>3D Alexandria Advanced - ParquetDB Docs: v0.25.1</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">ParquetDB Docs: v0.25.1</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/ParquetDB_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">ParquetDB Docs: v0.25.1</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../01_tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/01%20-%20Getting%20Started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/02%20-%20Normalization.html">Normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/03%20-%20Advanced%20Reads.html">Advanced Read Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/04%20-%20Supported%20Data%20Types.html">Supported Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/05%20-%20Advanced%20Updates.html">Advanced Update Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/06%20-%20Adding%20Metadata.html">Manipulating Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/07%20-%20Helper%20Methods.html">Other Helper Methods</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../02_internal/index.html">Internals of ParquetDB</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Internals of ParquetDB</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/01%20-%20parquetdb_internals.html">ParquetDB Internals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/01%20-%20parquetdb_internals.html#input-data-formats">Input Data Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/01%20-%20parquetdb_internals.html#preprocessing-incoming-data">Preprocessing Incoming Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/02%20-%20parquet_file_format.html">Parquet File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/02%20-%20parquet_file_format.html#parquet-file-layout">Parquet File Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/02%20-%20parquet_file_format.html#how-parquet-files-are-written">How Parquet Files are Written</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Examples for the ParquetDB package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Examples for the ParquetDB package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Example%201%20-%203D%20Alexandria%20Database.html">3D Alexandria Database</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">3D Alexandria Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example%203%20-%20Jarvis-dft_3d.html">ParquetDB with the Jarvis Dataset DFT_3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example%204%20-%20Jarvis-dft_pbe_2d.html">ParquetDB with the Jarvis Dataset DFT PBE 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/Needle-in-Haystack%20Benchmark.html">Needle-in-Haystack Benchmark Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/Input%20Update%20Benchmark.html">Input Update Benchmark Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/Create%20and%20Read%20Benchmark.html">Read/Write Benchmark Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/Update%20Into%20Constant%20Rows%20Benchmark.html">Update Benchmark Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/Full%20DB%20Updates%20Benchmark.html">Full DB Updates Benchmark Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarks/Small%20Benchmark.html">Small Benchmark</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../03_api/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../03_api/core/index.html">Core API</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Core API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../03_api/core/parquetdb.html">ParquetDB</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of ParquetDB</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../03_api/core/_autosummary/parquetdb.core.parquetdb.ParquetDB.html">parquetdb.core.parquetdb.ParquetDB</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../03_api/core/normalize_config.html">NormalizeConfig</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of NormalizeConfig</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../03_api/core/_autosummary/parquetdb.core.parquetdb.NormalizeConfig.html">parquetdb.core.parquetdb.NormalizeConfig</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../03_api/core/load_config.html">LoadConfig</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of LoadConfig</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../03_api/core/_autosummary/parquetdb.core.parquetdb.LoadConfig.html">parquetdb.core.parquetdb.LoadConfig</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../03_api/utils/index.html">Utils API</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Utils API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../03_api/utils/pyarrow_utils.html">PyArrowUtils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html">Contributing</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/examples/notebooks/Example 2 - 3D Alexandria Advanced.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="3D-Alexandria-Advanced">
<h1>3D Alexandria Advanced<a class="headerlink" href="#3D-Alexandria-Advanced" title="Link to this heading">¶</a></h1>
<p><img alt="alexandria_3d" src="../../_images/alexandria_3d_database.png" /></p>
<p>In this example, we will be using ParquetDB to do some analysis on the 3D Alexandria database. This assumes you have already done Example 1 - 3D Alexandria Database. In that example, we created a database from scratch. Here, we will be using the pre-existing database.</p>
<p>Materials can be classified into four main electronic categories based on their <strong>band gap</strong> characteristics: <strong>semiconductors</strong>, <strong>insulators</strong>, <strong>metals</strong>, and <strong>semimetals</strong>. The band gap is a crucial property that determines how a material conducts electricity and interacts with electromagnetic waves. This section of the notebook explores how to identify these categories by analyzing the <strong>direct band gap</strong> (<code class="docutils literal notranslate"><span class="pre">band_gap_dir</span></code>) and <strong>indirect band gap</strong> (<code class="docutils literal notranslate"><span class="pre">band_gap_ind</span></code>) values stored in the
database.</p>
<section id="Key-Concepts:">
<h2>Key Concepts:<a class="headerlink" href="#Key-Concepts:" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p><strong>Band Gap</strong>: The energy difference between the material’s valence band (occupied by electrons) and conduction band (unoccupied). It determines whether a material can conduct electricity:</p>
<ul class="simple">
<li><p>A <strong>large band gap</strong> indicates that the material does not conduct electricity easily, making it an <strong>insulator</strong>.</p></li>
<li><p>A <strong>small band gap</strong> allows for moderate conductivity, characterizing <strong>semiconductors</strong>.</p></li>
<li><p>A <strong>zero band gap</strong> suggests that electrons can move freely, which is typical of <strong>metals</strong> or <strong>semimetals</strong>.</p></li>
</ul>
</li>
<li><p><strong>Direct Band Gap vs. Indirect Band Gap</strong>:</p>
<ul class="simple">
<li><p><strong>Direct Band Gap</strong>: Electrons can transition directly between the valence and conduction bands without a change in momentum. This is particularly important for optoelectronic applications (e.g., LEDs and lasers).</p></li>
<li><p><strong>Indirect Band Gap</strong>: Electron transitions require a change in momentum, involving interactions with the material’s lattice vibrations (phonons).</p></li>
</ul>
</li>
</ol>
</section>
<section id="Material-Categories:">
<h2>Material Categories:<a class="headerlink" href="#Material-Categories:" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>Semiconductors</strong>:</p>
<ul>
<li><p>Band gap (direct or indirect): <strong>0.1 to 3 eV</strong>.</p></li>
<li><p>These materials exhibit moderate electrical conductivity, making them crucial for electronic devices like transistors and solar cells.</p></li>
</ul>
</li>
<li><p><strong>Insulators</strong>:</p>
<ul>
<li><p>Band gap (direct): <strong>&gt; 3 eV</strong>.</p></li>
<li><p>These materials do not conduct electricity under normal conditions due to their large band gap.</p></li>
</ul>
</li>
<li><p><strong>Metals</strong>:</p>
<ul>
<li><p>Direct band gap: <strong>0 eV</strong>.</p></li>
<li><p>Metals lack a band gap, allowing free movement of electrons, making them excellent conductors of electricity and heat.</p></li>
</ul>
</li>
<li><p><strong>Semimetals</strong>:</p>
<ul>
<li><p>Band gap (direct or indirect): <strong>&lt; 0.1 eV</strong>.</p></li>
<li><p>Semimetals have small or negligible band gaps, resulting in electronic behavior that lies between metals and semiconductors.</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="What-You'll-Learn-in-This-Section">
<h2>What You’ll Learn in This Section<a class="headerlink" href="#What-You'll-Learn-in-This-Section" title="Link to this heading">¶</a></h2>
<p>In the following cells, we:</p>
<ol class="arabic simple">
<li><p>Query the database to identify materials in each category.</p></li>
<li><p>Measure the time it takes to filter the data for performance benchmarking.</p></li>
<li><p>Extract the number of materials belonging to each category.</p></li>
</ol>
<section id="Setup">
<h3>Setup<a class="headerlink" href="#Setup" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pyarrow</span> <span class="kn">import</span> <span class="n">compute</span> <span class="k">as</span> <span class="n">pc</span>
<span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">parquetdb</span> <span class="kn">import</span> <span class="n">ParquetDB</span><span class="p">,</span> <span class="n">config</span>
<span class="kn">from</span> <span class="nn">parquetdb.utils.external_utils</span> <span class="kn">import</span> <span class="n">plot_periodic_table_heatmap</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">db_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">config</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;external&quot;</span><span class="p">,</span> <span class="s2">&quot;alexandria&quot;</span><span class="p">,</span> <span class="s2">&quot;AlexandriaDB&quot;</span><span class="p">,</span> <span class="s2">&quot;alexandria_3D&quot;</span>
<span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">ParquetDB</span><span class="p">(</span><span class="n">db_path</span><span class="o">=</span><span class="n">db_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
============================================================
PARQUETDB SUMMARY
============================================================
Database path: Z:\data\parquetdb\data\external\alexandria\AlexandriaDB\alexandria_3D

• Number of columns: 128
• Number of rows: 4389295
• Number of files: 1
• Number of rows per file: [4389295]
• Number of row groups per file: [22]
• Serialized metadata size per file: [377883] Bytes

############################################################
METADATA
############################################################

############################################################
COLUMN DETAILS
############################################################
• Columns:
    - composition.F
    - data.stress
    - composition.C
    - composition.Pu
    - composition.Kr
    - composition.Se
    - composition.Rh
    - composition.Co
    - composition.Te
    - composition.H
    - id
    - composition.Np
    - structure.lattice.gamma
    - structure.lattice.a
    - @module
    - composition.Zn
    - composition.Cs
    - data.prototype_id
    - composition.O
    - data.elements
    - composition.Na
    - data.e_phase_separation
    - entry_id
    - composition.Si
    - composition.Ti
    - structure.lattice.matrix
    - composition.Cd
    - composition.Dy
    - composition.K
    - composition.Pb
    - composition.Sm
    - composition.Ac
    - composition.In
    - structure.sites
    - composition.Ba
    - composition.Bi
    - composition.Mo
    - composition.Re
    - composition.P
    - data.nsites
    - composition.Ce
    - correction
    - composition.Ni
    - composition.Y
    - structure.lattice.c
    - composition.Mg
    - composition.Cr
    - composition.Ir
    - structure.lattice.b
    - data.decomposition
    - composition.Pr
    - composition.S
    - composition.Th
    - composition.Sr
    - data.mat_id
    - composition.He
    - composition.Pm
    - composition.Tc
    - data.spg
    - structure.lattice.pbc
    - composition.Ho
    - energy
    - composition.Ta
    - composition.Eu
    - parameters.dummy_field
    - @class
    - composition.Cu
    - composition.W
    - composition.Fe
    - structure.@module
    - energy_adjustments
    - composition.U
    - structure.lattice.beta
    - composition.Ne
    - composition.V
    - composition.Sb
    - composition.Lu
    - data.band_gap_ind
    - data.band_gap_dir
    - composition.N
    - composition.Hf
    - composition.Tl
    - composition.Tm
    - composition.Ar
    - structure.@class
    - data.dos_ef
    - composition.Er
    - composition.Pt
    - composition.Xe
    - composition.I
    - composition.Mn
    - composition.Ga
    - composition.Yb
    - composition.Ag
    - composition.Pa
    - composition.Nd
    - data.location
    - data.formula
    - composition.Pd
    - composition.Rb
    - data.energy_total
    - data.e_above_hull
    - structure.lattice.volume
    - composition.Hg
    - composition.Al
    - composition.Sc
    - composition.Tb
    - composition.Zr
    - composition.Br
    - composition.Gd
    - composition.Ca
    - structure.lattice.alpha
    - composition.Ru
    - composition.Ge
    - composition.B
    - data.e_form
    - composition.Li
    - composition.Sn
    - composition.Os
    - composition.Nb
    - composition.Be
    - composition.Cl
    - composition.Au
    - composition.La
    - data.total_mag
    - composition.As
    - structure.charge
    - data.energy_corrected

</pre></div></div>
</div>
<section id="Filtering-for-Electronic-Categories">
<h4>Filtering for Electronic Categories<a class="headerlink" href="#Filtering-for-Electronic-Categories" title="Link to this heading">¶</a></h4>
<p>In this section, we will filter the database to identify materials in each electronic category. We can easily do this with ParquetDB’s <code class="docutils literal notranslate"><span class="pre">read</span></code> method and applying the appropriate filters.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_semiconductor_filter</span><span class="p">():</span>

    <span class="c1"># Define direct and indirect band gap filters between 0.1 and 3 eV</span>
    <span class="n">band_gap_dir_in_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">3</span>
    <span class="p">)</span>
    <span class="n">band_gap_ind_in_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">3</span>
    <span class="p">)</span>

    <span class="c1"># Define conditional expression to handle the interaction between direct and indirect band gaps</span>
    <span class="n">filtered_expr</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">if_else</span><span class="p">(</span>
        <span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">)),</span>
        <span class="n">band_gap_ind_in_range</span><span class="p">,</span>
        <span class="n">band_gap_dir_in_range</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">filtered_expr</span>


<span class="k">def</span> <span class="nf">create_insulator_filter</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span>


<span class="k">def</span> <span class="nf">create_metal_filter</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>


<span class="k">def</span> <span class="nf">create_semimetal_filter</span><span class="p">():</span>

    <span class="c1"># Define direct and indirect band gap filters for semimetals. Less than 0.1 eV</span>
    <span class="n">band_gap_dir_in_range</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span>
    <span class="n">band_gap_ind_in_range</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span>

    <span class="c1"># Define conditional expression to handle the interaction between direct and indirect band gaps</span>
    <span class="n">filtered_expr</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">if_else</span><span class="p">(</span>
        <span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">)),</span>
        <span class="n">band_gap_ind_in_range</span><span class="p">,</span>
        <span class="n">band_gap_dir_in_range</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">filtered_expr</span>


<span class="n">semiconductor_filter</span> <span class="o">=</span> <span class="n">create_semiconductor_filter</span><span class="p">()</span>
<span class="n">insulator_filter</span> <span class="o">=</span> <span class="n">create_insulator_filter</span><span class="p">()</span>
<span class="n">metal_filter</span> <span class="o">=</span> <span class="n">create_metal_filter</span><span class="p">()</span>
<span class="n">semimetal_filter</span> <span class="o">=</span> <span class="n">create_semimetal_filter</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Now, let’s apply these filters to determine the distribution of materials in each category.</p>
<p>Here, I do not want the entire table, just the ids. If you read all the columns, you will likely run out of memory.</p>
<p>I will also get the band gap values to verify the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">semiconductor_table</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">,</span> <span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">],</span>
    <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="n">semiconductor_filter</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">insulator_table</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">,</span> <span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">],</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="n">insulator_filter</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">metal_table</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">,</span> <span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">],</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="n">metal_filter</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">semimetal_table</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">,</span> <span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">],</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="n">semimetal_filter</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">time_to_find_electronic_categories</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="n">n_semiconductors</span> <span class="o">=</span> <span class="n">semiconductor_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n_insulators</span> <span class="o">=</span> <span class="n">insulator_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n_metals</span> <span class="o">=</span> <span class="n">metal_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n_semimetals</span> <span class="o">=</span> <span class="n">semimetal_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of semiconductors: </span><span class="si">{</span><span class="n">n_semiconductors</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of insulators: </span><span class="si">{</span><span class="n">n_insulators</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of metals: </span><span class="si">{</span><span class="n">n_metals</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of semimetals: </span><span class="si">{</span><span class="n">n_semimetals</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Time to find electronic categories: </span><span class="si">{</span><span class="n">time_to_find_electronic_categories</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of semiconductors: 428588
Number of insulators: 59913
Number of metals: 2255051
Number of semimetals: 3905069
Time to find electronic categories: 0.2260 seconds
</pre></div></div>
</div>
<p>Great, we have the number of materials in each category and it took about ~0.27 seconds.</p>
<p>Again, to highlight the usefulness of ParquetDB, if we were to do this with the data in json format, it would take ~600 seconds for each individual query unless we extracted the different categories at the same time. Still take at minimum ~600 seconds to do this.</p>
<p>Now, let’s plot the distribution of band gaps for each category.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_band_gap_distribution</span><span class="p">(</span>
    <span class="n">semiconductor_table</span><span class="p">,</span> <span class="n">semimetal_table</span><span class="p">,</span> <span class="n">metal_table</span><span class="p">,</span> <span class="n">insulator_table</span>
<span class="p">):</span>
    <span class="c1"># Band gap ranges and materials info</span>
    <span class="n">band_gap_ranges</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0.1 &lt;= Eg &lt;= 3.0&quot;</span><span class="p">,</span> <span class="s2">&quot;Eg &lt; 0.1&quot;</span><span class="p">,</span> <span class="s2">&quot;Eg = 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Eg &gt; 3.0&quot;</span><span class="p">]</span>
    <span class="n">materials</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Semiconductors&quot;</span><span class="p">,</span> <span class="s2">&quot;Small Gap Materials&quot;</span><span class="p">,</span> <span class="s2">&quot;Metals&quot;</span><span class="p">,</span> <span class="s2">&quot;Insulators&quot;</span><span class="p">]</span>

    <span class="c1"># Convert PyArrow tables to Pandas DataFrames</span>
    <span class="n">df_semiconductors</span> <span class="o">=</span> <span class="n">semiconductor_table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
    <span class="n">df_semimetals</span> <span class="o">=</span> <span class="n">semimetal_table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
    <span class="n">df_metals</span> <span class="o">=</span> <span class="n">metal_table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
    <span class="n">df_insulators</span> <span class="o">=</span> <span class="n">insulator_table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

    <span class="c1"># Create a 2x2 grid of subplots</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># Flatten the 2D array for easy iteration</span>

    <span class="c1"># Define a helper function for plotting the distributions</span>
    <span class="k">def</span> <span class="nf">plot_band_gap_distribution</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">band_gap_range</span><span class="p">):</span>
        <span class="c1"># Plot histogram for direct band gap</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">],</span>
            <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Direct Band Gap&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># Plot histogram for indirect band gap</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">],</span>
            <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Indirect Band Gap&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Set x limits based on min and max of both distributions</span>
        <span class="c1"># min_gap = min(df[&quot;data.band_gap_dir&quot;].min(), df[&quot;data.band_gap_ind&quot;].min())</span>
        <span class="c1"># max_gap = max(df[&quot;data.band_gap_dir&quot;].max(), df[&quot;data.band_gap_ind&quot;].max())</span>

        <span class="n">min_gap_dir</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">max_gap_dir</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;data.band_gap_dir&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">min_gap_ind</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">max_gap_ind</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;data.band_gap_ind&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">material</span><span class="si">}</span><span class="s2">: Direct Band Gap (Minimum, Maximum): (</span><span class="si">{</span><span class="n">min_gap_dir</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">max_gap_dir</span><span class="si">}</span><span class="s2">), Indirect Band Gap (Minimum, Maximum): (</span><span class="si">{</span><span class="n">min_gap_ind</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">max_gap_ind</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">material</span> <span class="o">==</span> <span class="s2">&quot;Small Gap Materials&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_gap_dir</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_gap_dir</span><span class="p">,</span> <span class="n">max_gap_dir</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">material</span><span class="si">}</span><span class="se">\n</span><span class="s2">(</span><span class="si">{</span><span class="n">band_gap_range</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Band Gap (eV)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Plot each material category in its corresponding subplot</span>
    <span class="n">plot_band_gap_distribution</span><span class="p">(</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df_semiconductors</span><span class="p">,</span> <span class="n">materials</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">band_gap_ranges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">plot_band_gap_distribution</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">df_semimetals</span><span class="p">,</span> <span class="n">materials</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">band_gap_ranges</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plot_band_gap_distribution</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">df_metals</span><span class="p">,</span> <span class="n">materials</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">band_gap_ranges</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">plot_band_gap_distribution</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">df_insulators</span><span class="p">,</span> <span class="n">materials</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">band_gap_ranges</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plot_band_gap_distribution</span><span class="p">(</span>
    <span class="n">semiconductor_table</span><span class="p">,</span> <span class="n">semimetal_table</span><span class="p">,</span> <span class="n">metal_table</span><span class="p">,</span> <span class="n">insulator_table</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Semiconductors: Direct Band Gap (Minimum, Maximum): (0.1, 5.3968), Indirect Band Gap (Minimum, Maximum): (0.0, 3.0)
Small Gap Materials: Direct Band Gap (Minimum, Maximum): (0.0, 3.1953), Indirect Band Gap (Minimum, Maximum): (0.0, 0.0999)
Metals: Direct Band Gap (Minimum, Maximum): (0.0, 0.0), Indirect Band Gap (Minimum, Maximum): (0.0, 0.0)
Insulators: Direct Band Gap (Minimum, Maximum): (3.0001, 18.3179), Indirect Band Gap (Minimum, Maximum): (0.0, 17.7628)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\Users\lllang\AppData\Local\Temp\ipykernel_26724\3990681113.py:51: UserWarning: Attempting to set identical low and high xlims makes transformation singular; automatically expanding.
  ax.set_xlim(min_gap_dir, max_gap_dir)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_notebooks_Example_2_-_3D_Alexandria_Advanced_9_2.png" src="../../_images/examples_notebooks_Example_2_-_3D_Alexandria_Advanced_9_2.png" />
</div>
</div>
<p>Great this is a good visualization of the band gap distribution for each category. This is a good way to check if our filters are working as expected.</p>
</section>
<section id="Element-Distribution-of-Electronic-Categories">
<h4>Element Distribution of Electronic Categories<a class="headerlink" href="#Element-Distribution-of-Electronic-Categories" title="Link to this heading">¶</a></h4>
<p>Another interesting thing to look at is the distribution of elements in each category. We can do this by counting the number of times an element appears in each category.</p>
<p>For this task we need to create a dictionary which will keep track of the number of times an element appears in each category.</p>
<p>Let’s look at the schema to figure out what columns would be best to use for this task.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">schema</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_schema</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
@class: string
@module: string
composition.Ac: double
composition.Ag: double
composition.Al: double
composition.Ar: double
composition.As: double
composition.Au: double
composition.B: double
composition.Ba: double
composition.Be: double
composition.Bi: double
composition.Br: double
composition.C: double
composition.Ca: double
composition.Cd: double
composition.Ce: double
composition.Cl: double
composition.Co: double
composition.Cr: double
composition.Cs: double
composition.Cu: double
composition.Dy: double
composition.Er: double
composition.Eu: double
composition.F: double
composition.Fe: double
composition.Ga: double
composition.Gd: double
composition.Ge: double
composition.H: double
composition.He: double
composition.Hf: double
composition.Hg: double
composition.Ho: double
composition.I: double
composition.In: double
composition.Ir: double
composition.K: double
composition.Kr: double
composition.La: double
composition.Li: double
composition.Lu: double
composition.Mg: double
composition.Mn: double
composition.Mo: double
composition.N: double
composition.Na: double
composition.Nb: double
composition.Nd: double
composition.Ne: double
composition.Ni: double
composition.Np: double
composition.O: double
composition.Os: double
composition.P: double
composition.Pa: double
composition.Pb: double
composition.Pd: double
composition.Pm: double
composition.Pr: double
composition.Pt: double
composition.Pu: double
composition.Rb: double
composition.Re: double
composition.Rh: double
composition.Ru: double
composition.S: double
composition.Sb: double
composition.Sc: double
composition.Se: double
composition.Si: double
composition.Sm: double
composition.Sn: double
composition.Sr: double
composition.Ta: double
composition.Tb: double
composition.Tc: double
composition.Te: double
composition.Th: double
composition.Ti: double
composition.Tl: double
composition.Tm: double
composition.U: double
composition.V: double
composition.W: double
composition.Xe: double
composition.Y: double
composition.Yb: double
composition.Zn: double
composition.Zr: double
correction: double
data.band_gap_dir: double
data.band_gap_ind: double
data.decomposition: string
data.dos_ef: double
data.e_above_hull: double
data.e_form: double
data.e_phase_separation: double
data.elements: list&lt;element: string&gt;
  child 0, element: string
data.energy_corrected: double
data.energy_total: double
data.formula: string
data.location: string
data.mat_id: string
data.nsites: int64
data.prototype_id: string
data.spg: int64
data.stress: extension&lt;arrow.fixed_shape_tensor[value_type=double, shape=[3,3]]&gt;
data.total_mag: double
energy: double
energy_adjustments: list&lt;element: struct&lt;@class: string, @module: string, @version: null, value: double&gt;&gt;
  child 0, element: struct&lt;@class: string, @module: string, @version: null, value: double&gt;
      child 0, @class: string
      child 1, @module: string
      child 2, @version: null
      child 3, value: double
entry_id: null
id: int64
parameters.dummy_field: int16
structure.@class: string
structure.@module: string
structure.charge: int64
structure.lattice.a: double
structure.lattice.alpha: double
structure.lattice.b: double
structure.lattice.beta: double
structure.lattice.c: double
structure.lattice.gamma: double
structure.lattice.matrix: extension&lt;arrow.fixed_shape_tensor[value_type=double, shape=[3,3]]&gt;
structure.lattice.pbc: extension&lt;arrow.fixed_shape_tensor[value_type=bool, shape=[3]]&gt;
structure.lattice.volume: double
structure.sites: list&lt;element: struct&lt;abc: list&lt;element: double&gt;, label: string, properties: struct&lt;charge: double, forces: list&lt;element: double&gt;, magmom: double&gt;, species: list&lt;element: struct&lt;element: string, occu: int64&gt;&gt;, xyz: list&lt;element: double&gt;&gt;&gt;
  child 0, element: struct&lt;abc: list&lt;element: double&gt;, label: string, properties: struct&lt;charge: double, forces: list&lt;element: double&gt;, magmom: double&gt;, species: list&lt;element: struct&lt;element: string, occu: int64&gt;&gt;, xyz: list&lt;element: double&gt;&gt;
      child 0, abc: list&lt;element: double&gt;
          child 0, element: double
      child 1, label: string
      child 2, properties: struct&lt;charge: double, forces: list&lt;element: double&gt;, magmom: double&gt;
          child 0, charge: double
          child 1, forces: list&lt;element: double&gt;
              child 0, element: double
          child 2, magmom: double
      child 3, species: list&lt;element: struct&lt;element: string, occu: int64&gt;&gt;
          child 0, element: struct&lt;element: string, occu: int64&gt;
              child 0, element: string
              child 1, occu: int64
      child 4, xyz: list&lt;element: double&gt;
          child 0, element: double
</pre></div></div>
</div>
<p>We see the <code class="docutils literal notranslate"><span class="pre">data.elements</span></code> column is what we need, Let’s look at some values of this column.</p>
<blockquote>
<div><p>Note: You may have noticed the <code class="docutils literal notranslate"><span class="pre">composition.</span></code> columns with elements. In Alexandria3D, the compsosition is stored in a dictionary where the key is the element and the value is the number of atoms. When data is stored in ParquetDB, we have to combine schema across all materials. This means adding null element fields to each row even though they are not present the original material. We can achieve what we want by using this, but it would be a bit messy.</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;data.elements&quot;</span><span class="p">],</span> <span class="n">ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">])</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>data.elements</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10000</td>
      <td>[Ac, Sn, Ge]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>[Ac, Pr, Ho]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>[Ac, Pr, Tm]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>100</td>
      <td>[Ac, Pr, Br]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000</td>
      <td>[Ac, Pr, Rh]</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Let’s create the dictionary to store the results for each element</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;He&quot;</span><span class="p">,</span> <span class="s2">&quot;Li&quot;</span><span class="p">,</span> <span class="s2">&quot;Be&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;Ne&quot;</span><span class="p">,</span> <span class="s2">&quot;Na&quot;</span><span class="p">,</span> <span class="s2">&quot;Mg&quot;</span><span class="p">,</span> <span class="s2">&quot;Al&quot;</span><span class="p">,</span> <span class="s2">&quot;Si&quot;</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="s2">&quot;Cl&quot;</span><span class="p">,</span> <span class="s2">&quot;Ar&quot;</span><span class="p">,</span> <span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;Sc&quot;</span><span class="p">,</span> <span class="s2">&quot;Ti&quot;</span><span class="p">,</span> <span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="s2">&quot;Cr&quot;</span><span class="p">,</span> <span class="s2">&quot;Mn&quot;</span><span class="p">,</span> <span class="s2">&quot;Fe&quot;</span><span class="p">,</span> <span class="s2">&quot;Co&quot;</span><span class="p">,</span> <span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="s2">&quot;Cu&quot;</span><span class="p">,</span> <span class="s2">&quot;Zn&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Ga&quot;</span><span class="p">,</span> <span class="s2">&quot;Ge&quot;</span><span class="p">,</span> <span class="s2">&quot;As&quot;</span><span class="p">,</span> <span class="s2">&quot;Se&quot;</span><span class="p">,</span> <span class="s2">&quot;Br&quot;</span><span class="p">,</span> <span class="s2">&quot;Kr&quot;</span><span class="p">,</span> <span class="s2">&quot;Rb&quot;</span><span class="p">,</span> <span class="s2">&quot;Sr&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Zr&quot;</span><span class="p">,</span> <span class="s2">&quot;Nb&quot;</span><span class="p">,</span> <span class="s2">&quot;Mo&quot;</span><span class="p">,</span> <span class="s2">&quot;Tc&quot;</span><span class="p">,</span> <span class="s2">&quot;Ru&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Rh&quot;</span><span class="p">,</span> <span class="s2">&quot;Pd&quot;</span><span class="p">,</span> <span class="s2">&quot;Ag&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd&quot;</span><span class="p">,</span> <span class="s2">&quot;In&quot;</span><span class="p">,</span> <span class="s2">&quot;Sn&quot;</span><span class="p">,</span> <span class="s2">&quot;Sb&quot;</span><span class="p">,</span> <span class="s2">&quot;Te&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;Xe&quot;</span><span class="p">,</span> <span class="s2">&quot;Cs&quot;</span><span class="p">,</span> <span class="s2">&quot;Ba&quot;</span><span class="p">,</span> <span class="s2">&quot;La&quot;</span><span class="p">,</span> <span class="s2">&quot;Ce&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Pr&quot;</span><span class="p">,</span> <span class="s2">&quot;Nd&quot;</span><span class="p">,</span> <span class="s2">&quot;Pm&quot;</span><span class="p">,</span> <span class="s2">&quot;Sm&quot;</span><span class="p">,</span> <span class="s2">&quot;Eu&quot;</span><span class="p">,</span> <span class="s2">&quot;Gd&quot;</span><span class="p">,</span> <span class="s2">&quot;Tb&quot;</span><span class="p">,</span> <span class="s2">&quot;Dy&quot;</span><span class="p">,</span> <span class="s2">&quot;Ho&quot;</span><span class="p">,</span> <span class="s2">&quot;Er&quot;</span><span class="p">,</span> <span class="s2">&quot;Tm&quot;</span><span class="p">,</span> <span class="s2">&quot;Yb&quot;</span><span class="p">,</span> <span class="s2">&quot;Lu&quot;</span><span class="p">,</span> <span class="s2">&quot;Hf&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Ta&quot;</span><span class="p">,</span> <span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="s2">&quot;Re&quot;</span><span class="p">,</span> <span class="s2">&quot;Os&quot;</span><span class="p">,</span> <span class="s2">&quot;Ir&quot;</span><span class="p">,</span> <span class="s2">&quot;Pt&quot;</span><span class="p">,</span> <span class="s2">&quot;Au&quot;</span><span class="p">,</span> <span class="s2">&quot;Hg&quot;</span><span class="p">,</span> <span class="s2">&quot;Tl&quot;</span><span class="p">,</span> <span class="s2">&quot;Pb&quot;</span><span class="p">,</span> <span class="s2">&quot;Bi&quot;</span><span class="p">,</span> <span class="s2">&quot;Po&quot;</span><span class="p">,</span> <span class="s2">&quot;At&quot;</span><span class="p">,</span> <span class="s2">&quot;Rn&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Fr&quot;</span><span class="p">,</span> <span class="s2">&quot;Ra&quot;</span><span class="p">,</span> <span class="s2">&quot;Ac&quot;</span><span class="p">,</span> <span class="s2">&quot;Th&quot;</span><span class="p">,</span> <span class="s2">&quot;Pa&quot;</span><span class="p">,</span> <span class="s2">&quot;U&quot;</span><span class="p">,</span> <span class="s2">&quot;Np&quot;</span><span class="p">,</span> <span class="s2">&quot;Pu&quot;</span><span class="p">,</span> <span class="s2">&quot;Am&quot;</span><span class="p">,</span> <span class="s2">&quot;Cm&quot;</span><span class="p">,</span> <span class="s2">&quot;Bk&quot;</span><span class="p">,</span> <span class="s2">&quot;Cf&quot;</span><span class="p">,</span> <span class="s2">&quot;Es&quot;</span><span class="p">,</span> <span class="s2">&quot;Fm&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Md&quot;</span><span class="p">,</span> <span class="s2">&quot;No&quot;</span><span class="p">,</span> <span class="s2">&quot;Lr&quot;</span><span class="p">,</span> <span class="s2">&quot;Rf&quot;</span><span class="p">,</span> <span class="s2">&quot;Db&quot;</span><span class="p">,</span> <span class="s2">&quot;Sg&quot;</span><span class="p">,</span> <span class="s2">&quot;Bh&quot;</span><span class="p">,</span> <span class="s2">&quot;Hs&quot;</span><span class="p">,</span> <span class="s2">&quot;Mt&quot;</span><span class="p">,</span> <span class="s2">&quot;Ds&quot;</span><span class="p">,</span> <span class="s2">&quot;Rg&quot;</span><span class="p">,</span> <span class="s2">&quot;Cn&quot;</span><span class="p">,</span> <span class="s2">&quot;Nh&quot;</span><span class="p">,</span> <span class="s2">&quot;Fl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Mc&quot;</span><span class="p">,</span> <span class="s2">&quot;Lv&quot;</span><span class="p">,</span> <span class="s2">&quot;Ts&quot;</span><span class="p">,</span> <span class="s2">&quot;Og&quot;</span>
<span class="p">]</span>

<span class="c1"># This is for plotting the periodic table</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span>
    <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span>
<span class="p">]</span>

<span class="c1"># This is for plotting the periodic table</span>
<span class="n">periods</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symbols</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">periods</span><span class="p">))</span>
<span class="n">element_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">symbol</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
118 118 118
</pre></div></div>
</div>
<p>Now we need a method to determine which materials contain a given element in the <code class="docutils literal notranslate"><span class="pre">data.elements</span></code> column.</p>
<p>When performing searches over a column, it is recommended to use the <a class="reference external" href="https://arrow.apache.org/docs/python/api/compute.html" rel="noopener noreferrer" target="_blank">pyarrow compute methods</a>. This is because the compute methods are optimized in C++ and are much faster than the python methods. The methods perform the operations in parallel, making them much faster for large datasets. They are not bound by the GIL, so they can use all the cores of the machine.</p>
<p>However, I could not find a method to handle the list column in the way I wanted. So I will create a method from that uses the compute methods. In this way, I fully take advantage of the compute method’s parallel processing capabilities.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This method will filter a column to see if a list column contains the value we want</span>
<span class="k">def</span> <span class="nf">filter_list_column</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>

    <span class="c1"># Here I flateen all the lists into a single array</span>
    <span class="n">flat_list</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">list_flatten</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>

    <span class="c1"># I also need to keep track of the row indices of the original lists</span>
    <span class="n">flat_list_indices</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">list_parent_indices</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>

    <span class="c1"># Here I create a mask to find where the flattened list matches the value we want</span>
    <span class="n">equal_mask</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">flat_list</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="c1"># Here I use the mask to filter the row indices of the original table</span>
    <span class="n">equal_table_indices</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">flat_list_indices</span><span class="p">,</span> <span class="n">equal_mask</span><span class="p">)</span>

    <span class="c1"># Here I use the row indices to filter the original table</span>
    <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">equal_table_indices</span><span class="p">)</span>

<span class="c1"># Let&#39;s test the method</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;data.elements&quot;</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">column_name</span><span class="p">],</span> <span class="n">ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Table&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="n">filtered_table</span> <span class="o">=</span> <span class="n">filter_list_column</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="s2">&quot;Nd&quot;</span><span class="p">)</span>
<span class="n">df_filtered</span> <span class="o">=</span> <span class="n">filtered_table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Filtered Table&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Original Table
    id    data.elements
0    0     [Ac, Pr, Ho]
1    1  [Ac, Pr, In, N]
2    2  [Ac, Pr, In, O]
3    3     [Ac, Pr, Nd]
4    4     [Ac, Pr, Nd]
5    5     [Ac, Pr, Nd]
6    6     [Ac, Pr, Rh]
7    7     [Ac, Pr, Sm]
8    8     [Ac, Pr, Sm]
9    9     [Ac, Pr, Sm]
10  10     [Ac, Pr, Tm]
----------------------------------------------------------------------------------------------------
Filtered Table
   id data.elements
0   3  [Ac, Pr, Nd]
1   4  [Ac, Pr, Nd]
2   5  [Ac, Pr, Nd]
</pre></div></div>
</div>
<p>Now, let’s use this method to build distributions per electronic category.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">semiconductor_elements</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">element_dict</span><span class="p">)</span>
<span class="n">insulator_elements</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">element_dict</span><span class="p">)</span>
<span class="n">metal_elements</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">element_dict</span><span class="p">)</span>
<span class="n">semimetal_elements</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">element_dict</span><span class="p">)</span>


<span class="n">semiconductor_table</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;data.elements&quot;</span><span class="p">],</span>
    <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="n">semiconductor_filter</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">insulator_table</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;data.elements&quot;</span><span class="p">],</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="n">insulator_filter</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">metal_table</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;data.elements&quot;</span><span class="p">],</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="n">metal_filter</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">semimetal_table</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;data.elements&quot;</span><span class="p">],</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="n">semimetal_filter</span><span class="p">]</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">element_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">filtered_semiconductor_table</span> <span class="o">=</span> <span class="n">filter_list_column</span><span class="p">(</span><span class="n">semiconductor_table</span><span class="p">,</span> <span class="s2">&quot;data.elements&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
    <span class="n">semiconductor_elements</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_semiconductor_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">filtered_insulator_table</span> <span class="o">=</span> <span class="n">filter_list_column</span><span class="p">(</span><span class="n">insulator_table</span><span class="p">,</span> <span class="s2">&quot;data.elements&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
    <span class="n">insulator_elements</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_insulator_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">filtered_metal_table</span> <span class="o">=</span> <span class="n">filter_list_column</span><span class="p">(</span><span class="n">metal_table</span><span class="p">,</span> <span class="s2">&quot;data.elements&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
    <span class="n">metal_elements</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_metal_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">filtered_semimetal_table</span> <span class="o">=</span> <span class="n">filter_list_column</span><span class="p">(</span><span class="n">semimetal_table</span><span class="p">,</span> <span class="s2">&quot;data.elements&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
    <span class="n">semimetal_elements</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_semimetal_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="n">semiconductor_elements</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">semiconductor_elements</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
            <span class="s1">&#39;extended_group&#39;</span><span class="p">:</span> <span class="n">groups</span><span class="p">,</span>
            <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="n">periods</span>
            <span class="p">}</span>
<span class="n">element_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tmp_dict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">symbols</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_periodic_table_heatmap</span><span class="p">(</span><span class="n">element_df</span><span class="p">,</span> <span class="n">property_name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Semiconductors (0.1 &lt;= E$_g$ &lt;= 3.0)</span><span class="se">\n</span><span class="s2"> Element Occurrences Distribution&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Semiconductors (0.1 &lt;= E$_g$ &lt;= 3.0)\n Element Occurrences Distribution&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_notebooks_Example_2_-_3D_Alexandria_Advanced_21_1.png" src="../../_images/examples_notebooks_Example_2_-_3D_Alexandria_Advanced_21_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="n">semimetal_elements</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">semimetal_elements</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
            <span class="s1">&#39;extended_group&#39;</span><span class="p">:</span> <span class="n">groups</span><span class="p">,</span>
            <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="n">periods</span>
            <span class="p">}</span>
<span class="n">element_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tmp_dict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">symbols</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_periodic_table_heatmap</span><span class="p">(</span><span class="n">element_df</span><span class="p">,</span> <span class="n">property_name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Small Gap Materials (Eg &lt; 0.1)</span><span class="se">\n</span><span class="s2"> Element Occurrences Distribution&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Small Gap Materials (Eg &lt; 0.1)\n Element Occurrences Distribution&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_notebooks_Example_2_-_3D_Alexandria_Advanced_22_1.png" src="../../_images/examples_notebooks_Example_2_-_3D_Alexandria_Advanced_22_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="n">metal_elements</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">metal_elements</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
            <span class="s1">&#39;extended_group&#39;</span><span class="p">:</span> <span class="n">groups</span><span class="p">,</span>
            <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="n">periods</span>
            <span class="p">}</span>
<span class="n">element_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tmp_dict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">symbols</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_periodic_table_heatmap</span><span class="p">(</span><span class="n">element_df</span><span class="p">,</span> <span class="n">property_name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Metals (Eg = 0)</span><span class="se">\n</span><span class="s2"> Element Occurrences Distribution&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Metals (Eg = 0)\n Element Occurrences Distribution&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_notebooks_Example_2_-_3D_Alexandria_Advanced_23_1.png" src="../../_images/examples_notebooks_Example_2_-_3D_Alexandria_Advanced_23_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="n">insulator_elements</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">insulator_elements</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
            <span class="s1">&#39;extended_group&#39;</span><span class="p">:</span> <span class="n">groups</span><span class="p">,</span>
            <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="n">periods</span>
            <span class="p">}</span>
<span class="n">element_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tmp_dict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">symbols</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_periodic_table_heatmap</span><span class="p">(</span><span class="n">element_df</span><span class="p">,</span> <span class="n">property_name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Insulators (Eg &gt; 3.0)</span><span class="se">\n</span><span class="s2"> Element Occurrences Distribution&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Insulators (Eg &gt; 3.0)\n Element Occurrences Distribution&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_notebooks_Example_2_-_3D_Alexandria_Advanced_24_1.png" src="../../_images/examples_notebooks_Example_2_-_3D_Alexandria_Advanced_24_1.png" />
</div>
</div>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="Example%203%20-%20Jarvis-dft_3d.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">ParquetDB with the Jarvis Dataset DFT_3D</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="Example%201%20-%203D%20Alexandria%20Database.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">3D Alexandria Database</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Logan Lang
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">3D Alexandria Advanced</a><ul>
<li><a class="reference internal" href="#Key-Concepts:">Key Concepts:</a></li>
<li><a class="reference internal" href="#Material-Categories:">Material Categories:</a></li>
<li><a class="reference internal" href="#What-You'll-Learn-in-This-Section">What You’ll Learn in This Section</a><ul>
<li><a class="reference internal" href="#Setup">Setup</a><ul>
<li><a class="reference internal" href="#Filtering-for-Electronic-Categories">Filtering for Electronic Categories</a></li>
<li><a class="reference internal" href="#Element-Distribution-of-Electronic-Categories">Element Distribution of Electronic Categories</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=7ca58008"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/custom.js"></script>
    </body>
</html>