<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Contributing" href="../../CONTRIBUTING.html" /><link rel="prev" title="Utils API" href="index.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>PyArrowUtils - ParquetDB Docs: v0.24.1</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">ParquetDB Docs: v0.24.1</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/ParquetDB_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">ParquetDB Docs: v0.24.1</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../01_tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/01%20-%20Getting%20Started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/02%20-%20Normalization.html">Normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/03%20-%20Advanced%20Reads.html">Advanced Read Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/04%20-%20Supported%20Data%20Types.html">Supported Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/05%20-%20Advanced%20Updates.html">Advanced Update Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/06%20-%20Adding%20Metadata.html">Manipulating Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_tutorials/07%20-%20Helper%20Methods.html">Other Helper Methods</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../02_internal/index.html">Internals of ParquetDB</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Internals of ParquetDB</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/01%20-%20parquetdb_internals.html">ParquetDB Internals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/01%20-%20parquetdb_internals.html#input-data-formats">Input Data Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/01%20-%20parquetdb_internals.html#preprocessing-incoming-data">Preprocessing Incoming Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/02%20-%20parquet_file_format.html">Parquet File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/02%20-%20parquet_file_format.html#parquet-file-layout">Parquet File Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02_internal/02%20-%20parquet_file_format.html#how-parquet-files-are-written">How Parquet Files are Written</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/index.html">Examples for the ParquetDB package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Examples for the ParquetDB package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/Example%201%20-%203D%20Alexandria%20Database.html">3D Alexandria Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/Example%202%20-%203D%20Alexandria%20Advanced.html">3D Alexandria Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/Example%203%20-%20Jarvis-dft_3d.html">ParquetDB with the Jarvis Dataset DFT_3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/Example%204%20-%20Jarvis-dft_pbe_2d.html">ParquetDB with the Jarvis Dataset DFT PBE 2D</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../core/index.html">Core API</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Core API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../core/parquetdb.html">ParquetDB</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of ParquetDB</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/_autosummary/parquetdb.core.parquetdb.ParquetDB.html">parquetdb.core.parquetdb.ParquetDB</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../core/normalize_config.html">NormalizeConfig</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of NormalizeConfig</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/_autosummary/parquetdb.core.parquetdb.NormalizeConfig.html">parquetdb.core.parquetdb.NormalizeConfig</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../core/load_config.html">LoadConfig</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of LoadConfig</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/_autosummary/parquetdb.core.parquetdb.LoadConfig.html">parquetdb.core.parquetdb.LoadConfig</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Utils API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Utils API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">PyArrowUtils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html">Contributing</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/03_api/utils/pyarrow_utils.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="pyarrowutils">
<h1>PyArrowUtils<a class="headerlink" href="#pyarrowutils" title="Link to this heading">¶</a></h1>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.is_extension_type" title="parquetdb.utils.pyarrow_utils.is_extension_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_extension_type</span></code></a></p></td>
<td><p>Check if a PyArrow type is an extension type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.is_fixed_shape_tensor" title="parquetdb.utils.pyarrow_utils.is_fixed_shape_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_fixed_shape_tensor</span></code></a></p></td>
<td><p>Check if a PyArrow type is a fixed shape tensor type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.drop_duplicates" title="parquetdb.utils.pyarrow_utils.drop_duplicates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_duplicates</span></code></a></p></td>
<td><p>Drop duplicate rows from a PyArrow Table based on specified keys.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.join_tables" title="parquetdb.utils.pyarrow_utils.join_tables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">join_tables</span></code></a></p></td>
<td><p>Join two PyArrow tables based on specified key columns.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.sort_schema" title="parquetdb.utils.pyarrow_utils.sort_schema"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sort_schema</span></code></a></p></td>
<td><p>Sort the fields in a PyArrow schema alphabetically by field name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.table_schema_cast" title="parquetdb.utils.pyarrow_utils.table_schema_cast"><code class="xref py py-obj docutils literal notranslate"><span class="pre">table_schema_cast</span></code></a></p></td>
<td><p>Cast a PyArrow table to match a new schema.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.unify_schemas" title="parquetdb.utils.pyarrow_utils.unify_schemas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unify_schemas</span></code></a></p></td>
<td><p>Unify two PyArrow schemas while preserving and merging their metadata.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.delete_columns" title="parquetdb.utils.pyarrow_utils.delete_columns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_columns</span></code></a></p></td>
<td><p>Delete specified columns from a PyArrow table.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.delete_ids" title="parquetdb.utils.pyarrow_utils.delete_ids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_ids</span></code></a></p></td>
<td><p>Delete rows from a table based on ID values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.delete_field_values" title="parquetdb.utils.pyarrow_utils.delete_field_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_field_values</span></code></a></p></td>
<td><p>Delete rows from a table based on values in a specified field.</p></td>
</tr>
</tbody>
</table>
</div>
<section id="module-parquetdb.utils.pyarrow_utils">
<span id="detailed-documentation"></span><h2>Detailed Documentation<a class="headerlink" href="#module-parquetdb.utils.pyarrow_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.add_new_null_fields_in_column">
<span class="sig-name descname"><span class="pre">add_new_null_fields_in_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.add_new_null_fields_in_column" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.add_new_null_fields_in_struct">
<span class="sig-name descname"><span class="pre">add_new_null_fields_in_struct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_struct_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.add_new_null_fields_in_struct" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.add_new_null_fields_in_table">
<span class="sig-name descname"><span class="pre">add_new_null_fields_in_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_schema</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.add_new_null_fields_in_table" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.align_table">
<span class="sig-name descname"><span class="pre">align_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_schema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Schema</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Table</span></span></span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.align_table" title="Link to this definition">¶</a></dt>
<dd><p>Aligns the given table to the new schema, filling in missing fields or struct fields with null values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_table</strong> (<em>pyarrow.Table</em>) – The table to align.</p></li>
<li><p><strong>new_schema</strong> (<em>pyarrow.Schema</em>) – The target schema to align the table to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Table</em> – The aligned table with:
- Missing fields filled with null values
- Fields ordered according to new schema
- Struct fields aligned to match new schema</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.convert_list_column_to_fixed_tensor">
<span class="sig-name descname"><span class="pre">convert_list_column_to_fixed_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.convert_list_column_to_fixed_tensor" title="Link to this definition">¶</a></dt>
<dd><p>Converts a variable-sized list column in a PyArrow Table to a fixed-size list (tensor) column.</p>
<p>This function checks if a column in the table is of list type and converts it to a fixed-size list array
(i.e., tensor) based on the dimensions of the first non-null element in the list. The fixed-size list
array is then updated in the table.</p>
<p>This will only convert floats, integers, booleans, and decimals. Also it will only convert if the list is homogeneous.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pyarrow.Table</em>) – The input PyArrow Table containing the column to be converted.</p></li>
<li><p><strong>column_name</strong> (<em>str</em>) – The name of the column in the table which contains list values to be converted to fixed-size arrays.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Table</em> – The updated table where the specified column has been converted to a fixed-size list array (tensor).</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">list_</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="n">data</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modified_table</span> <span class="o">=</span> <span class="n">convert_lists_to_fixed_size_list_arrays_in_column</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s1">&#39;col1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">modified_table</span><span class="p">)</span>
<span class="go">pyarrow.Table</span>
<span class="go">col1: fixed_shape_tensor&lt;list&lt;item: int64&gt;[2]&gt;</span>
<span class="go">----</span>
<span class="go">col1: [ [1, 2], [3, 4], [5, 6] ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.create_empty_batch_generator">
<span class="sig-name descname"><span class="pre">create_empty_batch_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">schema:</span> <span class="pre">~pyarrow.lib.Schema,</span> <span class="pre">columns:</span> <span class="pre">list</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">special_fields:</span> <span class="pre">list</span> <span class="pre">=</span> <span class="pre">[pyarrow.Field&lt;id:</span> <span class="pre">int64&gt;]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.create_empty_batch_generator" title="Link to this definition">¶</a></dt>
<dd><p>Orders the fields in a table’s struct columns to match a new schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pa.Table</em>) – The original table.</p></li>
<li><p><strong>new_schema</strong> (<em>pa.Schema</em>) – The new schema with the desired field order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.Table</em> – A new table with fields ordered according to <cite>new_schema</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">([{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}],</span> <span class="n">schema</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_schema</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">order_fields_in_table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">new_schema</span><span class="p">)</span>
<span class="go">pyarrow.Table</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.create_empty_table">
<span class="sig-name descname"><span class="pre">create_empty_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">schema:</span> <span class="pre">~pyarrow.lib.Schema,</span> <span class="pre">columns:</span> <span class="pre">list</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">special_fields:</span> <span class="pre">list</span> <span class="pre">=</span> <span class="pre">[pyarrow.Field&lt;id:</span> <span class="pre">int64&gt;]</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Table</span></span></span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.create_empty_table" title="Link to this definition">¶</a></dt>
<dd><p>Creates an empty PyArrow table with the same schema as the dataset or specific columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> (<em>pa.Schema</em>) – The schema of the dataset to mimic in the empty generator.</p></li>
<li><p><strong>columns</strong> (<em>list, optional</em>) – List of column names to include in the empty table. Defaults to None.</p></li>
<li><p><strong>special_fields</strong> (<em>list, optional</em>) – A list of fields to use if the schema is empty. Defaults to a field named ‘id’ of type <cite>pa.int64()</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.Table</em> – An empty PyArrow table with the specified schema.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_empty_table</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="go">pyarrow.Table</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.create_nested_arrays_dict_from_flattened_table">
<span class="sig-name descname"><span class="pre">create_nested_arrays_dict_from_flattened_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.create_nested_arrays_dict_from_flattened_table" title="Link to this definition">¶</a></dt>
<dd><p>Reconstructs a nested dictionary of arrays from a flattened PyArrow table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table</strong> (<em>pa.Table</em>) – The PyArrow table with flattened field names.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>dict</em> – A dictionary where keys represent the nested field structure, and values are the corresponding arrays.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a.b&#39;</span><span class="p">,</span> <span class="s1">&#39;a.c&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_nested_arrays_dict_from_flattened_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="go">{&#39;a&#39;: {&#39;b&#39;: &lt;pyarrow.Array object at 0x...&gt;, &#39;c&#39;: &lt;pyarrow.Array object at 0x...&gt;}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.create_struct_arrays_from_dict">
<span class="sig-name descname"><span class="pre">create_struct_arrays_from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nested_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.create_struct_arrays_from_dict" title="Link to this definition">¶</a></dt>
<dd><p>Creates PyArrow StructArrays and schema from a nested dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nested_dict</strong> (<em>dict</em>) – The dictionary where keys represent field names and values are either arrays or nested dictionaries.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>tuple of (pa.StructArray, pa.StructType)</em> – A tuple containing the created StructArray and its corresponding StructType schema.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nested_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_struct_arrays_from_dict</span><span class="p">(</span><span class="n">nested_dict</span><span class="p">)</span>
<span class="go">(&lt;pyarrow.StructArray object at 0x...&gt;, StructType(a: int64, b: StructType(c: int64)))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.delete_columns">
<span class="sig-name descname"><span class="pre">delete_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.delete_columns" title="Link to this definition">¶</a></dt>
<dd><p>Delete specified columns from a PyArrow table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pyarrow.Table</em>) – The input table to delete columns from.</p></li>
<li><p><strong>columns</strong> (<em>list of str</em>) – List of column names to delete.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Table</em> – A new table with the specified columns removed.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_columns</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="go">pyarrow.Table</span>
<span class="go">a: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.delete_field_values">
<span class="sig-name descname"><span class="pre">delete_field_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.delete_field_values" title="Link to this definition">¶</a></dt>
<dd><p>Delete rows from a table based on values in a specified field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pyarrow.Table</em>) – The input table to delete rows from.</p></li>
<li><p><strong>values</strong> (<em>array-like</em>) – List of values to delete.</p></li>
<li><p><strong>field_name</strong> (<em>str</em>) – Name of the field to match values against.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Table</em> – A new table with rows matching the specified values in the given field removed.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_field_values</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="go">pyarrow.Table</span>
<span class="go">id: int64</span>
<span class="go">category: string</span>
<span class="go">----</span>
<span class="go">id         category</span>
<span class="go">2          B</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.delete_ids">
<span class="sig-name descname"><span class="pre">delete_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.delete_ids" title="Link to this definition">¶</a></dt>
<dd><p>Delete rows from a table based on ID values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pyarrow.Table</em>) – The input table to delete rows from.</p></li>
<li><p><strong>ids</strong> (<em>array-like</em>) – List of ID values to delete.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Table</em> – A new table with rows matching the specified IDs removed.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_ids</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">pyarrow.Table</span>
<span class="go">id: int64</span>
<span class="go">value: string</span>
<span class="go">----</span>
<span class="go">id         value</span>
<span class="go">1          a</span>
<span class="go">4          d</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.drop_duplicates">
<span class="sig-name descname"><span class="pre">drop_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.drop_duplicates" title="Link to this definition">¶</a></dt>
<dd><p>Drop duplicate rows from a PyArrow Table based on specified keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pyarrow.Table</em>) – The input table from which duplicates will be removed.</p></li>
<li><p><strong>keys</strong> (<em>list of str</em>) – A list of column names that determine the uniqueness of rows.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Table</em> – A new table with duplicates removed, keeping the first occurrence of each unique key combination.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function keeps the first occurrence of each unique key combination.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.fill_null_nested_structs">
<span class="sig-name descname"><span class="pre">fill_null_nested_structs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.fill_null_nested_structs" title="Link to this definition">¶</a></dt>
<dd><p>Fills null values within a nested PyArrow StructArray, recursively processing any nested structs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> (<em>pa.Array</em>) – The PyArrow StructArray that may contain nested structs with null values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.StructArray</em> – A new StructArray with nulls handled recursively within nested structs.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}}],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())]))]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill_null_nested_structs</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<span class="go">&lt;pyarrow.StructArray object at 0x...&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.fill_null_nested_structs_in_table">
<span class="sig-name descname"><span class="pre">fill_null_nested_structs_in_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.fill_null_nested_structs_in_table" title="Link to this definition">¶</a></dt>
<dd><p>Recursively fills null values within nested struct columns of a PyArrow table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table</strong> (<em>pa.Table</em>) – The PyArrow table to process for nested structs and null values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.Table</em> – A new table where nulls within nested struct columns have been handled.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">([{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}}],</span> <span class="n">schema</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())]))]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill_null_nested_structs_in_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="go">pyarrow.Table</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.find_difference_between_pyarrow_schemas">
<span class="sig-name descname"><span class="pre">find_difference_between_pyarrow_schemas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.find_difference_between_pyarrow_schemas" title="Link to this definition">¶</a></dt>
<dd><p>Finds the difference between two PyArrow schemas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema1</strong> (<em>pyarrow.Schema</em>) – The first schema to compare.</p></li>
<li><p><strong>schema2</strong> (<em>pyarrow.Schema</em>) – The second schema to compare.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>set</em> – A set of field names that are present in <cite>schema1</cite> but not in <cite>schema2</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema1</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema2</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_difference_between_pyarrow_schemas</span><span class="p">(</span><span class="n">schema1</span><span class="p">,</span> <span class="n">schema2</span><span class="p">)</span>
<span class="go">{&#39;a&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.flatten_nested_structs">
<span class="sig-name descname"><span class="pre">flatten_nested_structs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.flatten_nested_structs" title="Link to this definition">¶</a></dt>
<dd><p>Flattens nested structs within a PyArrow array, creating fully qualified field names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>pa.Array</em>) – The PyArrow StructArray containing nested fields to flatten.</p></li>
<li><p><strong>parent_name</strong> (<em>str</em>) – The name of the parent field, used to generate fully qualified field names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>list of tuple</em> – A list of tuples, where each tuple contains a flattened array and its corresponding field.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}}],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())]))]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flatten_nested_structs</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">[(array([1, 2], type=int32), Field&lt;name: a.b, type: int32&gt;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.flatten_table">
<span class="sig-name descname"><span class="pre">flatten_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.flatten_table" title="Link to this definition">¶</a></dt>
<dd><p>Flattens nested struct columns within a PyArrow table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table</strong> (<em>pa.Table</em>) – The PyArrow table containing nested struct columns to flatten.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.Table</em> – A new table with flattened struct fields.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">([{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}}],</span> <span class="n">schema</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())]))]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flatten_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="go">pyarrow.Table</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.flatten_table_in_column">
<span class="sig-name descname"><span class="pre">flatten_table_in_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.flatten_table_in_column" title="Link to this definition">¶</a></dt>
<dd><p>Flattens a nested struct column in a PyArrow Table.</p>
<p>This function takes a column from a PyArrow Table that is of struct type, and flattens its fields into separate columns.
The original struct column is replaced by these individual columns in the resulting table. The column names are
sorted alphabetically after flattening.</p>
<p>This does not work in in the table_column_callbacks function.
As it will remove existing field of the nested structs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pyarrow.Table</em>) – The input PyArrow Table containing the column to be flattened.</p></li>
<li><p><strong>column_name</strong> (<em>str</em>) – The name of the struct column in the table to be flattened.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Table</em> – The updated table where the nested struct column has been flattened into individual columns.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">())]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="n">data</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modified_table</span> <span class="o">=</span> <span class="n">flatten_table_in_column</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s1">&#39;col1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">modified_table</span><span class="p">)</span>
<span class="go">pyarrow.Table</span>
<span class="go">a: int64</span>
<span class="go">b: int64</span>
<span class="go">----</span>
<span class="go">a: [1, 3]</span>
<span class="go">b: [2, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.infer_pyarrow_types">
<span class="sig-name descname"><span class="pre">infer_pyarrow_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.infer_pyarrow_types" title="Link to this definition">¶</a></dt>
<dd><p>Infers PyArrow types for the given dictionary of data. The function skips the ‘id’ field and infers
the data types for all other keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_dict</strong> (<em>dict</em>) – A dictionary where keys represent field names and values represent data values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>dict</em> – A dictionary where keys are field names and values are the inferred PyArrow data types.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;string_value&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infer_pyarrow_types</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<span class="go">{&#39;a&#39;: DataType(int64), &#39;b&#39;: DataType(string)}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.is_empty_struct_in_column">
<span class="sig-name descname"><span class="pre">is_empty_struct_in_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.is_empty_struct_in_column" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.is_extension_type">
<span class="sig-name descname"><span class="pre">is_extension_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.is_extension_type" title="Link to this definition">¶</a></dt>
<dd><p>Check if a PyArrow type is an extension type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>type</strong> (<em>pyarrow.DataType</em>) – The PyArrow type to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>bool</em> – True if the type is an extension type, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.is_fixed_shape_tensor">
<span class="sig-name descname"><span class="pre">is_fixed_shape_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.is_fixed_shape_tensor" title="Link to this definition">¶</a></dt>
<dd><p>Check if a PyArrow type is a fixed shape tensor type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>type</strong> (<em>pyarrow.DataType</em>) – The PyArrow type to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>bool</em> – True if the type is a fixed shape tensor, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.join_tables">
<span class="sig-name descname"><span class="pre">join_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'left</span> <span class="pre">outer'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coalesce_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.join_tables" title="Link to this definition">¶</a></dt>
<dd><p>Join two PyArrow tables based on specified key columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_table</strong> (<em>pyarrow.Table</em>) – The left table for the join operation.</p></li>
<li><p><strong>right_table</strong> (<em>pyarrow.Table</em>) – The right table for the join operation.</p></li>
<li><p><strong>left_keys</strong> (<em>str or list of str</em>) – Column name(s) from the left table to join on.</p></li>
<li><p><strong>right_keys</strong> (<em>str or list of str, optional</em>) – Column name(s) from the right table to join on. If None, uses left_keys.</p></li>
<li><p><strong>join_type</strong> (<em>str, optional</em>) – Type of join to perform. Default is “left outer”.
Supported types: “left outer”, “right outer”, “inner”, “full outer”.</p></li>
<li><p><strong>left_suffix</strong> (<em>str, optional</em>) – Suffix to append to overlapping column names from the left table.</p></li>
<li><p><strong>right_suffix</strong> (<em>str, optional</em>) – Suffix to append to overlapping column names from the right table.</p></li>
<li><p><strong>coalesce_keys</strong> (<em>bool, optional</em>) – Whether to combine join keys that appear in both tables. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Table</em> – A new table containing the joined data with:
- All columns from both tables (except join keys which are coalesced if specified)
- Column name conflicts resolved using the provided suffixes
- Combined metadata from both input tables</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function:
- Preserves the original data types and metadata
- Handles overlapping column names by adding suffixes
- Removes temporary index columns used for joining
- Combines metadata from both input tables</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">left</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">joined</span> <span class="o">=</span> <span class="n">join_tables</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">joined</span><span class="o">.</span><span class="n">column_names</span>
<span class="go">[&#39;id&#39;, &#39;value&#39;, &#39;score&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.merge_schemas">
<span class="sig-name descname"><span class="pre">merge_schemas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_schema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incoming_schema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Schema</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Schema</span></span></span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.merge_schemas" title="Link to this definition">¶</a></dt>
<dd><p>Merges two PyArrow schemas, combining fields and recursively merging struct fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_schema</strong> (<em>pyarrow.Schema</em>) – The existing schema to merge.</p></li>
<li><p><strong>incoming_schema</strong> (<em>pyarrow.Schema</em>) – The new schema to merge with the existing schema.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.Schema</em> – A new PyArrow schema that represents the merged result of the two input schemas.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">current_schema</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incoming_schema</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">float64</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">merge_schemas</span><span class="p">(</span><span class="n">current_schema</span><span class="p">,</span> <span class="n">incoming_schema</span><span class="p">)</span>
<span class="go">Schema(a: int32, b: string, c: float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.merge_structs">
<span class="sig-name descname"><span class="pre">merge_structs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StructType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incoming_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StructType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">StructType</span></span></span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.merge_structs" title="Link to this definition">¶</a></dt>
<dd><p>Recursively merges two PyArrow StructTypes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_type</strong> (<em>pa.StructType</em>) – The existing struct type.</p></li>
<li><p><strong>incoming_type</strong> (<em>pa.StructType</em>) – The new struct type to merge with the existing struct.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.StructType</em> – A new PyArrow StructType representing the merged result of the two input structs.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">current</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incoming</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">float64</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">merge_structs</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">incoming</span><span class="p">)</span>
<span class="go">StructType(a: int32, b: string, c: float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.order_fields_in_struct">
<span class="sig-name descname"><span class="pre">order_fields_in_struct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_struct_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.order_fields_in_struct" title="Link to this definition">¶</a></dt>
<dd><p>Orders the fields in a struct array to match a new struct type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>column_array</strong> (<em>pa.Array</em>) – The original struct array.</p></li>
<li><p><strong>new_struct_type</strong> (<em>pa.StructType</em>) – The new struct type with the desired field order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.Array</em> – A new struct array with fields ordered according to <cite>new_struct_type</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">column_array</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_struct_type</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">order_fields_in_struct</span><span class="p">(</span><span class="n">column_array</span><span class="p">,</span> <span class="n">new_struct_type</span><span class="p">)</span>
<span class="go">&lt;pyarrow.StructArray object at 0x...&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.order_fields_in_table">
<span class="sig-name descname"><span class="pre">order_fields_in_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_schema</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.order_fields_in_table" title="Link to this definition">¶</a></dt>
<dd><p>Orders the fields in a table’s struct columns to match a new schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pa.Table</em>) – The original table.</p></li>
<li><p><strong>new_schema</strong> (<em>pa.Schema</em>) – The new schema with the desired field order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.Table</em> – A new table with fields ordered according to <cite>new_schema</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">([{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}],</span> <span class="n">schema</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_schema</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">order_fields_in_table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">new_schema</span><span class="p">)</span>
<span class="go">pyarrow.Table</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.rebuild_nested_table">
<span class="sig-name descname"><span class="pre">rebuild_nested_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'table'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.rebuild_nested_table" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.replace_empty_structs">
<span class="sig-name descname"><span class="pre">replace_empty_structs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column_array:</span> <span class="pre">~pyarrow.lib.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dummy_field=pyarrow.Field&lt;dummy_field:</span> <span class="pre">int16&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.replace_empty_structs" title="Link to this definition">¶</a></dt>
<dd><p>Replaces empty PyArrow struct arrays with a struct containing a dummy field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>column_array</strong> (<em>pa.Array</em>) – The column array to inspect for empty structs.</p></li>
<li><p><strong>dummy_field</strong> (<em>pa.Field, optional</em>) – The dummy field to insert into empty structs. Defaults to a field named ‘dummy_field’ with type <cite>pa.int16()</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.Array</em> – The input array with empty structs replaced by structs containing the dummy field.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">column_array</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replace_empty_structs</span><span class="p">(</span><span class="n">column_array</span><span class="p">)</span>
<span class="go">&lt;pyarrow.StructArray object at 0x...&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.replace_empty_structs_in_column">
<span class="sig-name descname"><span class="pre">replace_empty_structs_in_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dummy_field=pyarrow.Field&lt;dummy_field:</span> <span class="pre">int16&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_nested=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.replace_empty_structs_in_column" title="Link to this definition">¶</a></dt>
<dd><p>Replaces empty struct values in a specified column of a PyArrow Table with a dummy field.</p>
<p>This function checks if the given column in the table is of a struct type. If it is, it replaces
any empty structs in the column with a dummy struct that includes the <cite>dummy_field</cite>. The modified
column is then updated in the table and returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pyarrow.Table</em>) – The input PyArrow Table containing the column to be modified.</p></li>
<li><p><strong>column_name</strong> (<em>str</em>) – The name of the column in the table where empty structs should be replaced.</p></li>
<li><p><strong>dummy_field</strong> (<em>pyarrow.Field, optional</em>) – A dummy field to insert into empty structs, by default <cite>pa.field(‘dummy_field’, pa.int16())</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Table</em> – The updated table where empty structs in the specified column have been replaced with dummy structs.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{}],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">())]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="n">data</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modified_table</span> <span class="o">=</span> <span class="n">replace_empty_structs_in_column</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s1">&#39;col1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">modified_table</span><span class="p">)</span>
<span class="go">pyarrow.Table</span>
<span class="go">col1: struct&lt;a: int64, dummy_field: int16&gt;</span>
<span class="go">----</span>
<span class="go">col1: [{a: 1}, {dummy_field: 0}, {dummy_field: 0}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.replace_empty_structs_in_table">
<span class="sig-name descname"><span class="pre">replace_empty_structs_in_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dummy_field=pyarrow.Field&lt;dummy_field:</span> <span class="pre">int16&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.replace_empty_structs_in_table" title="Link to this definition">¶</a></dt>
<dd><p>Replaces empty struct fields in a PyArrow table with a struct containing a dummy field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pa.Table</em>) – The table in which to replace empty structs.</p></li>
<li><p><strong>dummy_field</strong> (<em>pa.Field, optional</em>) – The dummy field to insert into empty structs. Defaults to a field named ‘dummy_field’ with type <cite>pa.int16()</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.Table</em> – The table with empty struct fields replaced by structs containing the dummy field.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">([{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}],</span> <span class="n">schema</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())]))]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replace_empty_structs_in_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="go">pyarrow.Table</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.schema_equal">
<span class="sig-name descname"><span class="pre">schema_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.schema_equal" title="Link to this definition">¶</a></dt>
<dd><p>Compare two PyArrow schemas for equality, including metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema1</strong> (<em>pyarrow.Schema</em>) – First schema to compare</p></li>
<li><p><strong>schema2</strong> (<em>pyarrow.Schema</em>) – Second schema to compare</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>bool</em> – True if schemas and their metadata are equal, False otherwise</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function checks both the schema structure (fields and types) as well as
the metadata dictionaries for equality. Two schemas are considered equal only
if both their structure and metadata match exactly.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.sort_schema">
<span class="sig-name descname"><span class="pre">sort_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.sort_schema" title="Link to this definition">¶</a></dt>
<dd><p>Sort the fields in a PyArrow schema alphabetically by field name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>schema</strong> (<em>pyarrow.Schema</em>) – Input schema to sort</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Schema</em> – New schema with fields sorted alphabetically, preserving the original metadata</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function maintains the original schema metadata while reordering the fields.
This is useful for ensuring consistent field ordering across different schema instances.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.table_column_callbacks">
<span class="sig-name descname"><span class="pre">table_column_callbacks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.table_column_callbacks" title="Link to this definition">¶</a></dt>
<dd><p>Applies a list of callback functions to each column in a PyArrow Table.</p>
<p>This function iterates over all columns in the provided table and applies each callback function from the
<cite>callbacks</cite> list to each column. The callbacks are expected to modify the table in some way (e.g., transforming
or updating columns), and the updated table is returned after all callbacks are applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pyarrow.Table</em>) – The input PyArrow Table to which the callback functions will be applied.</p></li>
<li><p><strong>callbacks</strong> (<em>list of callable, optional</em>) – A list of functions to be applied to each column in the table. Each callback should take two arguments:
the table and the name of the column.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Table</em> – The updated table after applying all callback functions to each column.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">uppercase_column_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">column_name</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">new_name</span> <span class="o">=</span> <span class="n">column_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">column</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">column_name</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">rename_columns</span><span class="p">([</span><span class="n">new_name</span> <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">column_name</span> <span class="k">else</span> <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">column_names</span><span class="p">])</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="n">data</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modified_table</span> <span class="o">=</span> <span class="n">table_column_callbacks</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">uppercase_column_names</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">modified_table</span><span class="p">)</span>
<span class="go">pyarrow.Table</span>
<span class="go">COL1: int64</span>
<span class="go">----</span>
<span class="go">COL1: [1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.table_schema_cast">
<span class="sig-name descname"><span class="pre">table_schema_cast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_schema</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.table_schema_cast" title="Link to this definition">¶</a></dt>
<dd><p>Cast a PyArrow table to match a new schema.</p>
<p>This function casts an existing PyArrow table to match a new schema, handling:
- Fields present in both schemas (cast to new type)
- New fields (added as null columns)
- Special handling for fixed shape tensors
- Reordering columns alphabetically</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_table</strong> (<em>pyarrow.Table</em>) – The table to be cast to the new schema</p></li>
<li><p><strong>new_schema</strong> (<em>pyarrow.Schema</em>) – The target schema to cast the table to</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Table</em> – A new table with the schema matching new_schema</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If casting a list column fails, typically due to nested null fields</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.unify_schemas">
<span class="sig-name descname"><span class="pre">unify_schemas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">promote_options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'permissive'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.unify_schemas" title="Link to this definition">¶</a></dt>
<dd><p>Unify two PyArrow schemas while preserving and merging their metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema_list</strong> (<em>list of pyarrow.Schema</em>) – List containing exactly two schemas to unify. The first schema is considered
the current schema and the second is the new schema to merge with.</p></li>
<li><p><strong>promote_options</strong> (<em>str, optional</em>) – Options for type promotion when unifying schemas. Default is “permissive”.
See PyArrow documentation for valid options.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Schema</em> – A new unified schema that:
- Contains all fields from both input schemas
- Has merged metadata from both schemas if they differ
- Has field types promoted according to promote_options</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function:
- Extracts and merges metadata from both schemas if they differ
- Uses PyArrow’s unify_schemas to combine the field definitions
- Reattaches the merged metadata to the final schema</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema1</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema2</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unified</span> <span class="o">=</span> <span class="n">unify_schemas</span><span class="p">([</span><span class="n">schema1</span><span class="p">,</span> <span class="n">schema2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unified</span><span class="o">.</span><span class="n">names</span>
<span class="go">[&#39;id&#39;, &#39;name&#39;, &#39;age&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.update_fixed_shape_tensor">
<span class="sig-name descname"><span class="pre">update_fixed_shape_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.update_fixed_shape_tensor" title="Link to this definition">¶</a></dt>
<dd><p>Update a fixed shape tensor array with values from another array, preserving nulls.</p>
<p>This function updates values in current_array with non-null values from update_array.
Where update_array has null values, the original values from current_array are preserved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_array</strong> (<em>pyarrow.Array</em>) – The original fixed shape tensor array to be updated</p></li>
<li><p><strong>update_array</strong> (<em>pyarrow.Array</em>) – The array containing update values. Must be the same length as current_array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyarrow.Array</em> – A new array with values from current_array updated with non-null values from update_array</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function preserves the null/non-null status of elements:
- Where update_array has non-null values, those values replace current_array values
- Where update_array has null values, current_array values are preserved
- The returned array maintains the same length as the input arrays</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">current</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">update_fixed_shape_tensor</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">update</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">to_pylist</span><span class="p">()</span>
<span class="go">[[7,8], [3,4], [9,10]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.update_flattend_table">
<span class="sig-name descname"><span class="pre">update_flattend_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incoming_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['id']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.update_flattend_table" title="Link to this definition">¶</a></dt>
<dd><p>Updates the current table using the values from the incoming table by flattening both
tables, applying the updates, and then rebuilding the nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_table</strong> (<em>pa.Table</em>) – The current PyArrow table to update.</p></li>
<li><p><strong>incoming_table</strong> (<em>pa.Table</em>) – The incoming PyArrow table containing updated values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.Table</em> – The updated PyArrow table with flattened and rebuilt structure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parquetdb.utils.pyarrow_utils.update_schema">
<span class="sig-name descname"><span class="pre">update_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parquetdb.utils.pyarrow_utils.update_schema" title="Link to this definition">¶</a></dt>
<dd><p>Update the schema of a given table based on a provided schema or field modifications.</p>
<p>This function allows updating the schema of a PyArrow table by either replacing the entire schema
or modifying individual fields within the existing schema. It can take a dictionary of field
names and their corresponding new field definitions to update specific fields in the schema.
Alternatively, a completely new schema can be provided to replace the current one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_current</strong> (<em>pa.Schema</em>) – The current schema of the table.</p></li>
<li><p><strong>schema</strong> (<em>pa.Schema, optional</em>) – A new schema to replace the existing schema of the table. If provided, this will
completely override the current schema.</p></li>
<li><p><strong>field_dict</strong> (<em>dict, optional</em>) – A dictionary where the keys are existing field names and the values are the new
PyArrow field definitions to replace the old ones. This is used for selectively
updating specific fields within the current schema.</p></li>
<li><p><strong>update_metadata</strong> (<em>bool, optional</em>) – Whether to update the metadata of the table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pa.Table</em> – A new PyArrow table with the updated schema.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../CONTRIBUTING.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Contributing</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Utils API</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Logan Lang
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">PyArrowUtils</a><ul>
<li><a class="reference internal" href="#module-parquetdb.utils.pyarrow_utils">Detailed Documentation</a><ul>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.add_new_null_fields_in_column"><code class="docutils literal notranslate"><span class="pre">add_new_null_fields_in_column()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.add_new_null_fields_in_struct"><code class="docutils literal notranslate"><span class="pre">add_new_null_fields_in_struct()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.add_new_null_fields_in_table"><code class="docutils literal notranslate"><span class="pre">add_new_null_fields_in_table()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.align_table"><code class="docutils literal notranslate"><span class="pre">align_table()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.convert_list_column_to_fixed_tensor"><code class="docutils literal notranslate"><span class="pre">convert_list_column_to_fixed_tensor()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.create_empty_batch_generator"><code class="docutils literal notranslate"><span class="pre">create_empty_batch_generator()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.create_empty_table"><code class="docutils literal notranslate"><span class="pre">create_empty_table()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.create_nested_arrays_dict_from_flattened_table"><code class="docutils literal notranslate"><span class="pre">create_nested_arrays_dict_from_flattened_table()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.create_struct_arrays_from_dict"><code class="docutils literal notranslate"><span class="pre">create_struct_arrays_from_dict()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.delete_columns"><code class="docutils literal notranslate"><span class="pre">delete_columns()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.delete_field_values"><code class="docutils literal notranslate"><span class="pre">delete_field_values()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.delete_ids"><code class="docutils literal notranslate"><span class="pre">delete_ids()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.drop_duplicates"><code class="docutils literal notranslate"><span class="pre">drop_duplicates()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.fill_null_nested_structs"><code class="docutils literal notranslate"><span class="pre">fill_null_nested_structs()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.fill_null_nested_structs_in_table"><code class="docutils literal notranslate"><span class="pre">fill_null_nested_structs_in_table()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.find_difference_between_pyarrow_schemas"><code class="docutils literal notranslate"><span class="pre">find_difference_between_pyarrow_schemas()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.flatten_nested_structs"><code class="docutils literal notranslate"><span class="pre">flatten_nested_structs()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.flatten_table"><code class="docutils literal notranslate"><span class="pre">flatten_table()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.flatten_table_in_column"><code class="docutils literal notranslate"><span class="pre">flatten_table_in_column()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.infer_pyarrow_types"><code class="docutils literal notranslate"><span class="pre">infer_pyarrow_types()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.is_empty_struct_in_column"><code class="docutils literal notranslate"><span class="pre">is_empty_struct_in_column()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.is_extension_type"><code class="docutils literal notranslate"><span class="pre">is_extension_type()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.is_fixed_shape_tensor"><code class="docutils literal notranslate"><span class="pre">is_fixed_shape_tensor()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.join_tables"><code class="docutils literal notranslate"><span class="pre">join_tables()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.merge_schemas"><code class="docutils literal notranslate"><span class="pre">merge_schemas()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.merge_structs"><code class="docutils literal notranslate"><span class="pre">merge_structs()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.order_fields_in_struct"><code class="docutils literal notranslate"><span class="pre">order_fields_in_struct()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.order_fields_in_table"><code class="docutils literal notranslate"><span class="pre">order_fields_in_table()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.rebuild_nested_table"><code class="docutils literal notranslate"><span class="pre">rebuild_nested_table()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.replace_empty_structs"><code class="docutils literal notranslate"><span class="pre">replace_empty_structs()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.replace_empty_structs_in_column"><code class="docutils literal notranslate"><span class="pre">replace_empty_structs_in_column()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.replace_empty_structs_in_table"><code class="docutils literal notranslate"><span class="pre">replace_empty_structs_in_table()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.schema_equal"><code class="docutils literal notranslate"><span class="pre">schema_equal()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.sort_schema"><code class="docutils literal notranslate"><span class="pre">sort_schema()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.table_column_callbacks"><code class="docutils literal notranslate"><span class="pre">table_column_callbacks()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.table_schema_cast"><code class="docutils literal notranslate"><span class="pre">table_schema_cast()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.unify_schemas"><code class="docutils literal notranslate"><span class="pre">unify_schemas()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.update_fixed_shape_tensor"><code class="docutils literal notranslate"><span class="pre">update_fixed_shape_tensor()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.update_flattend_table"><code class="docutils literal notranslate"><span class="pre">update_flattend_table()</span></code></a></li>
<li><a class="reference internal" href="#parquetdb.utils.pyarrow_utils.update_schema"><code class="docutils literal notranslate"><span class="pre">update_schema()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=0d70ca51"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/custom.js"></script>
    </body>
</html>